<form name="form" ng-submit="submit()" novalidate="novalidate"><h1>{{ 'CARRIER_' | translate }} {{ carrier.name }}</h1><div class="row"><div class="col-sm-6"><div ng-class="{ 'has-error': form.name.$invalid && !form.name.$pristine }" class="form-group"><label for="name">{{ 'NAME' | translate }}</label><input type="text" name="name" ng-model="carrier.name" required="required" id="name" class="form-control"/><p ng-show="form.name.$invalid" class="text-danger">{{ 'NAME_MANDATORY' | translate }}</p></div></div><div class="col-sm-6"><div ng-class="{ 'has-error': form.tracking_url.$invalid && !form.tracking_url.$pristine }" class="form-group"><label for="tracking_url">{{ 'TRACKING_URL' | translate }}</label><input type="text" name="tracking_url" ng-model="carrier.tracking_url" ng-pattern="/.*@.*/" id="tracking_url" class="form-control"/><p ng-show="form.tracking_url.$invalid" class="text-danger">{{ 'AT_REPLACED' | translate }}</p></div></div></div><div class="row"><div ng-repeat="lang in langs" class="col-sm-6"><div class="form-group"><label for="description_{{ lang }}">{{ 'DESCRIPTION' | translate }} {{ lang }}</label><input id="description_{{ lang }}" type="text" name="description_{{ lang }}" ng-model="carrier.description[lang]" class="form-control"/></div></div></div><uib-accordion><div uib-accordion-group="uib-accordion-group" heading="{{ 'COUNTRIES' | translate }}" class="panel-default"><p>{{ 'CARRIER_HAS_SPECIAL_RATES' | translate }} {{ 'NOTE_REST_WORLD' | translate }}</p><div class="row"><div class="col-xs-6"><div class="panel panel-default"><div class="panel-heading">{{ 'SELECTED' | translate }}</div><div class="list-group"><button type="button" ng-repeat="groupid in carrier.countries_groups" ng-click="remove_countriesgroup(groupid)" class="list-group-item">{{ carrier_name_from_id(groupid) }}<span class="pull-right"><i class="fa fa-arrow-right"></i></span></button><button type="button" ng-repeat="code in carrier.countries" ng-click="remove_country(code)" class="list-group-item">{{ name_from_code(code) }}<span class="pull-right"><i class="fa fa-arrow-right"></i></span></button></div></div></div><div class="col-xs-6"><div class="panel panel-default"><div class="panel-heading">{{ 'AVAILABLE' | translate }}</div><div class="list-group"><input type="text" ng-model="query" placeholder="{{ 'FILTER' | translate }}" class="list-group-item"/><button type="button" ng-repeat="group in filtered_countriesgroups() | filter:query" ng-click="add_countriesgroup(group.id)" class="list-group-item"><i class="fa fa-arrow-left"></i> &nbsp;&nbsp; {{ group.name }}</button><button type="button" ng-repeat="country in filtered_countries() | filter:query" ng-click="add_country(country.code)" class="list-group-item"><i class="fa fa-arrow-left"></i> &nbsp;&nbsp; {{ country.name }}</button></div></div></div></div></div></uib-accordion><div class="panel panel-default"><div class="panel-heading">{{ 'PURCHASE_PRICE' | translate }}</div><div class="panel-body"><table><tr><td class="text-right"><button type="button" uib-tooltip="{{ 'ADD_WEIGHT' | translate }}" ng-click="carrier.costs.unshift({weight:1})" ng-show="carrier.costs.length == 0 || carrier.costs[0].weight > 1" class="btn btn-success btn-sm"><i class="fa fa-plus"></i></button></td><td ng-repeat="weight in carrier.costs track by $index" class="text-center"><button type="button" uib-tooltip="{{ 'DELETE_WEIGHT' | translate }}" ng-click="carrier.costs.splice($index, 1)" class="btn btn-danger btn-sm"><i class="fa fa-times"></i></button><button type="button" uib-tooltip="{{ 'ADD_WEIGHT' | translate }}" ng-click="carrier.costs.splice($index+1,0,{weight:weight.weight+1})" class="btn btn-success btn-sm pull-right"><i class="fa fa-plus"></i></button></td></tr><tr><th class="text-right">{{ 'GRAMS' | translate }}</th><th ng-repeat="weight in carrier.costs track by $index"><input type="number" min="1" ng-model="weight.weight" ng-if="carrier.costs.length==1" class="form-control"/><input type="number" min="1" max="{{ carrier.costs[$index+1].weight - 1 }}" ng-model="weight.weight" ng-if="$first&&!$last" class="form-control"/><input type="number" min="{{ carrier.costs[$index-1].weight + 1 }}" max="{{ carrier.costs[$index+1].weight - 1 }}" ng-model="weight.weight" ng-if="$middle" class="form-control"/><input type="number" min="{{ carrier.costs[$index-1].weight + 1 }}" ng-model="weight.weight" ng-if="$last&&!$first" class="form-control"/></th></tr><tr ng-repeat="groupid in carrier.countries_groups"><td class="nowrap text-right">{{ carrier_name_from_id(groupid) }}</td><td ng-repeat="weight in carrier.costs track by $index"><div class="input-group"><input type="number" step="0.01" ng-model="weight.costs[groupid]" class="form-control"/><span class="input-group-addon">{{ CONFIG.currency }}</span></div></td></tr><tr ng-repeat="countrycode in carrier.countries"><td class="nowrap text-right">{{ name_from_code(countrycode) }}</td><td ng-repeat="weight in carrier.costs track by $index"><div class="input-group"><input type="number" step="0.01" ng-model="weight.costs[id_from_code(countrycode)]" class="form-control"/><span class="input-group-addon">{{ CONFIG.currency }}</span></div></td></tr><tr><td class="nowrap text-right">{{ 'REST_WORLD' | translate }}</td><td ng-repeat="weight in carrier.costs track by $index"><div class="input-group"><input type="number" step="0.01" ng-model="weight.costs.rest" class="form-control"/><span class="input-group-addon">{{ CONFIG.currency }}</span></div></td></tr></table></div></div><div id="page-buttons"><button type="submit" uib-tooltip="{{ 'SAVE' | translate }}" ng-disabled="form.$invalid" class="btn btn-link"><i class="fa fa-check-circle fa-4x text-success"></i></button><button type="button" ng-click="delete()" uib-tooltip="{{ 'REMOVE' | translate }}" class="btn btn-link"><i class="fa fa-times-circle fa-4x text-danger"></i></button><a ui-sref="carriers" uib-tooltip="{{ 'BACK' | translate }}" class="btn btn-link"><i ng-class="{'text-primary': form.$pristine, 'text-danger': form.$dirty }" class="fa fa-arrow-circle-left fa-4x"></i></a></div></form>