<h1>{{ 'MY_CART' | translate }}</h1><form name="form" ng-show="cart.count()" ng-submit="confirm()" novalidate="novalidate"><h2 ng-show="user.get().auth">{{ 'MY_PRODUCTS_CHOICE' | translate }}</h2><div class="list-group"><div ng-repeat="line in cart.list()" uib-popover-template="'/common/product_'+line.product.type+'_popup.html'" popover-trigger="'mouseenter'" popover-enable="line.product.details" class="list-group-item cart-list"><div class="row"><div class="col-xs-7 col-sm-6 col-md-7 col-lg-8"><a href="{{ line.product.path }}"><span class="hidden-xs hidden-sm pull-left"><img ng-src="{{ line.product.main_photo.thumbnail_url }}" ng-show="line.product.main_photo" class="cart-illustration"/><span ng-hide="line.product.main_photo" class="cart-illustration-placeholder"><i class="fa fa-ban"></i> </span></span>{{ line.product.name }}</a><br/>{{ 'UNIT_PRICE_' | translate }} {{ line.product.net_price | currency:CONFIG.currency }}<br/><span ng-show="line.quantity <= line.product.stock" class="text-success">{{ 'IN_STOCK' | translate }}</span><span ng-show="line.quantity > line.product.stock && line.product.overstock_delay >= 0" uib-tooltip="{{ 'FOR_FAST_SHIPPING_ORDER_LESS_THAN_X' | translate:{QTY: line.product.stock} }}" class="text-danger">{{ 'SHIPPING_DELAY_X' | translate:{QTY: line.product.overstock_delay} }}</span><span ng-show="line.quantity > line.product.stock && line.product.overstock_delay < 0" class="text-danger">{{ 'INSUFFICIENT_STOCK' | translate }}</span></div><div class="col-xs-5 col-sm-3 col-lg-2"><label for="qty-{{ line.product.reference }}" class="hidden-xs">{{ 'QUANTITY_' | translate }}</label><div class="input-group"><input id="qty-{{ line.product.reference }}" type="number" min="1" ng-model="line.quantity" ng-model-options="{debounce:{default:100}}" class="form-control"/><span class="input-group-btn"><button type="button" ng-click="cart.remove(line.product.id, line.data)" uib-tooltip="{{ 'REMOVE' | translate }}" class="btn btn-danger"><i class="fa fa-trash"></i></button></span></div></div><div class="col-sm-3 col-md-2 text-right"><strong>{{ 'TOTAL_' | translate }} <br class="hidden-xs"/>{{ line.product.net_price*line.quantity | currency:CONFIG.currency }}</strong></div></div></div><div class="list-group-item"><div class="row"><div class="col-xs-7 col-sm-6 col-md-7 col-lg-8"><span ng-show="cart.delay()">{{ 'SHIPPING_DELAY_X' | translate:{QTY: cart.delay()} }}</span><span ng-hide="cart.delay()" class="text-danger">{{ 'INSUFFICIENT_STOCK' | translate }}</span></div><div class="col-xs-5 col-sm-3 col-lg-2"><button type="button" ng-click="cart.reset()" class="btn btn-danger btn-block"><i class="fa fa-trash"></i> {{ 'EMPTY' | translate }}</button></div><div class="col-sm-3 col-md-2 text-right"><strong class="text-primary">{{ 'SUBTOTAL_' | translate }}<br class="hidden-xs"/>{{ cart.total() | currency:CONFIG.currency }}</strong></div></div></div></div><div ng-show="user.get().auth"><div class="panel panel-default"><div class="panel-heading">{{ 'SAVE_FOR_LATER' | translate }}</div><div class="panel-body"><div ng-show="user.get().auth && saved_cart"><div class="btn-group"><a ui-sref="saved_carts" class="btn btn-primary"><i class="fa fa-bookmark""></i> {{ 'CART_SAVED' | translate }}</a><button type="button" ng-click="cart.reset()" class="btn btn-danger"><i class="fa fa-trash"></i> {{ 'EMPTY_CART' | translate }}</button></div></div><div ng-hide="!user.get().auth || saved_cart"><div class="input-group"><input type="text" ng-model="cartname" placeholder="{{ 'CART_NAME' | translate }}" required="required" class="form-control"/><span class="input-group-btn"><button type="button" uib-tooltip="{{ 'SAVE_CART' | translate }}" ng-click="save_cart()" ng-disabled="form.$invalid" class="btn btn-primary"><i class="fa fa-bookmark"></i> {{ 'SAVE' | translate }}</button></span></div></div></div></div><h2>{{ 'MY_ORDER_OPTIONS' | translate }}</h2><div ng-show="cart.delay() && user.get().addresses.length"><div class="row"><div class="col-md-6"><div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title"><i class="fa fa-map-marker"></i> {{ 'DELIVERY_ADDRESS' | translate }}</h3></div><div class="panel-body"><div class="form-group"><select name="delivery" ng-model="choice.delivery_address" ng-options="address.id as address.title for address in user.get().addresses" required="required" class="form-control"></select></div><p>{{ 'WILL_SHIP_TO_' | translate }}</p><pre ng-bind="full_address(choice.delivery_address)" class="well"></pre><div class="btn-group btn-group-justified"><div class="btn-group"><button type="button" ng-disabled="!choice.delivery_address" ng-click="modify_address(choice.delivery_address)" class="btn btn-info"><i class="fa fa-pencil"></i> {{ 'MODIFY' | translate }}</button></div><div class="btn-group"><button type="button" ng-click="add_address()" class="btn btn-warning"><i class="fa fa-plus"></i> {{ 'NEW_ADDRESS' | translate }}</button></div></div></div></div></div><div class="col-md-6"><div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title"><i class="fa fa-map-marker"></i> {{ 'BILLING_ADDRESS' | translate }}</h3></div><div class="panel-body"><div ng-class="{'bottom-no-space': choice.delivery_as_billing}" class="form-group"><button type="button" ng-model="choice.delivery_as_billing" uib-btn-checkbox="uib-btn-checkbox" class="btn btn-primary btn-block"><span ng-show="choice.delivery_as_billing"><i class="fa fa-check"></i> {{ 'USE_DELIVERY_ADDRESS' | translate }}</span><span ng-hide="choice.delivery_as_billing"><i class="fa fa-times"></i> {{ 'USE_DELIVERY_ADDRESS_NO' | translate }}</span></button></div><div ng-hide="choice.delivery_as_billing"><div class="form-group"><select name="billing" ng-model="choice.billing_address" ng-options="address.id as address.title for address in user.get().addresses" class="form-control"></select></div><pre ng-bind="full_address(choice.billing_address)" class="well"></pre><div class="btn-group btn-group-justified"><div class="btn-group"><button type="button" ng-disabled="!choice.billing_address" ng-click="modify_address(choice.billing_address)" class="btn btn-info"><i class="fa fa-pencil"></i> {{ 'MODIFY' | translate }}</button></div><div class="btn-group"><button type="button" ng-click="add_address()" class="btn btn-warning"><i class="fa fa-plus"></i> {{ 'NEW_ADDRESS' | translate }}</button></div></div></div></div></div></div></div><div class="panel panel-default"><div class="panel-heading"><h2 class="panel-title"><i class="fa fa-truck"></i> {{ 'SHIPPING' | translate }}</h2></div><div class="list-group options-list-clickable"><label ng-repeat="available_carrier in get_available_carriers()" class="list-group-item"><div class="row"><div class="col-xs-8"><input type="radio" ng-model="choice.carrier" ng-value="available_carrier.carrier.id"/>{{ available_carrier.carrier.description }} ({{ available_carrier.carrier.name }})</div><div class="col-xs-4 text-right"><b>{{ available_carrier.cost | currency:CONFIG.currency }}</b></div></div></label></div></div><div class="well"><div class="row"><div class="col-xs-8 col-md-9 text-right">{{ 'SUBTOTAL' | translate }}</div><div class="col-xs-4 col-md-3 text-right">{{ cart.total() | currency:CONFIG.currency }}</div></div><div class="row"><div class="col-xs-8 col-md-9 text-right">{{ 'SHIPPING_FEE' | translate }}</div><div class="col-xs-4 col-md-3 text-right">{{ get_shipping_fee() | currency:CONFIG.currency }}</div></div><div class="row total-cost text-info"><div class="col-xs-8 col-md-9 text-right">{{ 'TOTAL' | translate }}</div><div class="col-xs-4 col-md-3 text-right"><b>{{ cart.total() + get_shipping_fee() | currency:CONFIG.currency }}</b></div></div></div><div class="panel panel-default"><div class="panel-heading"><h2 class="panel-title"><i class="fa fa-money"></i> {{ 'PAYMENT' | translate }}</h2></div><div class="list-group options-list-clickable"><label ng-repeat="mode in payments" class="list-group-item"><input type="radio" ng-model="choice.payment" ng-value="mode.id"/><i class="fa fa-{{ mode.icon }}"></i> {{ mode.description }}</label></div></div><textarea placeholder="{{ 'YOUR_MESSAGE' | translate }}" ng-model="choice.message" class="form-control bottom-large-space"></textarea><div class="panel panel-default"><div class="panel-body text-right options-list-clickable"><label><i class="fa fa-recycle"></i> {{ 'ACCEPT_REUSED_PACKAGE' | translate }} <input type="checkbox" ng-model="choice.accept_reused_package"/></label><br/><label><i class="fa fa-file-text-o"></i> {{ 'PAPER_INVOICE' | translate }} <input type="checkbox" ng-model="choice.paper_invoice"/></label><br/><label><i class="fa fa-check"></i> <b>{{ 'AGREE_TO_TERMS' | translate }} <a href="#" ng-click="open_terms()">(?)</a></b> <input type="checkbox" ng-model="choice.accept_terms"/></label><div ng-show="cart.overstock()"><b class="text-danger">{{ 'UNDERSTAND_DELAY' | translate:{QTY: cart.delay()} }}</b></div></div></div><div class="row"><div class="col-md-5 col-lg-7 bottom-large-space"><small>{{ 'LEGAL_NOTICE' | translate }}</small></div><div class="col-md-7 col-lg-5 text-right"><button type="submit" id="proceed" ng-disabled="!(choice.delivery_address && (choice.delivery_as_billing || choice.billing_address) && choice.payment && choice.accept_terms)" class="btn btn-lg btn-success"> {{ 'VERIFY_AND_CONFIRM' | translate }} <i class="fa fa-chevron-right"></i></button></div></div></div></div></form><div ng-show="cart.count() && (!user.get().auth || !user.get().addresses.length)" class="panel panel-default"><div class="panel-heading">{{ 'ESTIMATE_SHIPPING_FEE' | translate }}</div><div class="panel-body"><div class="row"><div class="col-sm-6"><select id="address_country" name="address_country" ng-model="estimation_country" ng-options="country.code as prefixed(country) for country in countries.get()" class="form-control"></select></div><div class="col-sm-6"><input type="text" disabled="disabled" ng-show="shipping_fee_estimation()" value="{{ 'FROM_PRICE' | translate }}{{ shipping_fee_estimation() | currency:CONFIG.currency }}" class="form-control"/></div></div></div></div><div ng-show="user.get().auth && cart.count() && !user.get().addresses.length" class="panel panel-default"><div class="panel-body"><p class="lead text-center">{{ 'DEFINE_ADDRESS' | translate }}</p><button type="button" ng-click="add_address()" class="btn btn-lg btn-block btn-success"><i class="fa fa-home"></i> {{ 'CREATE_ADDRESS' | translate }}</button></div></div><div ng-show="cart.count() && !user.get().auth" class="alert alert-warning text-center"><p class="bottom-space">{{ 'LOGIN_OR_REGISTER_TO_PLACE_ORDER' | translate }}</p><div class="btn-group"><a href="#" ng-click="user.forcelogin()" class="btn btn-default"><i class="fa fa-sign-in""></i> {{ 'LOGIN' | translate }}</a><a ui-sref="register" class="btn btn-default"><i class="fa fa-user-plus"></i> {{ 'REGISTER' | translate }}</a></div></div><div ng-hide="cart.count()" class="alert alert-danger text-center">{{ 'CART_EMPTY_FULL' | translate }}</div><div ng-hide="!cart.count() || cart.delay()" class="alert alert-danger text-center"><p>{{ 'CART_CANNOT_BE_ORDER_BECAUSE_INSUFFICIENT_STOCK' | translate }}</p></div>